# core/src/arena_alloc.c

## –û–±—â–µ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–ª–ª–æ–∫–∞—Ü–∏–µ–π –ø–∞–º—è—Ç–∏ –≤ –∞—Ä–µ–Ω–µ. –û–Ω –≤–∫–ª—é—á–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è, —É–¥–∞–ª–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫, –∞ —Ç–∞–∫–∂–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–≤–æ–±–æ–¥–Ω—ã–º–∏ –±–ª–æ–∫–∞–º–∏ –ø–∞–º—è—Ç–∏. –ì–ª–∞–≤–Ω–æ–π —Ü–µ–ª—å—é –¥–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞ —è–≤–ª—è–µ—Ç—Å—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç—å—é —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∑–∞—Ç—Ä–∞—Ç–∞–º–∏ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –§—É–Ω–∫—Ü–∏–∏
- ```static inline void update_next_of_prev_block(Arena *arena, Block *block, Block *new_val)```
  - –û–±–Ω–æ–≤–ª—è–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å `next_free` –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞.
  - –ï—Å–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Å–≤–æ–±–æ–¥–Ω—ã–π –±–ª–æ–∫ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –∞—Ä–µ–Ω—ã.

- ```static inline void update_prev_of_next_block(Block *block, Block *new_val)```
  - –û–±–Ω–æ–≤–ª—è–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å `prev_free` —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞.
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Å–≤—è–∑–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –±–ª–æ–∫–æ–≤.

- ```static inline void update_max_free_block_on_free(Arena *arena, size_t block_size)```
  - –û–±–Ω–æ–≤–ª—è–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞ –ø—Ä–∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–∏.
  - –£—á–∏—Ç—ã–≤–∞–µ—Ç —Å–ª—É—á–∞–∏, –∫–æ–≥–¥–∞ –æ—Å–≤–æ–±–æ–¥–∏–ª—Å—è –±–ª–æ–∫ –±–æ–ª—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.

- ```static inline Block *create_empty_block(Block *prev_block)```
  - –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –ø—É—Å—Ç–æ–π –±–ª–æ–∫ –≤ –∫–æ–Ω—Ü–µ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –±–ª–æ–∫–∞.
  - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –Ω–æ–≤–æ–≥–æ –±–ª–æ–∫–∞ –≤ 0 –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –µ–≥–æ —É–∫–∞–∑–∞—Ç–µ–ª–∏.

- ```static inline size_t find_second_largest_size(Arena *arena)```
  - –ù–∞—Ö–æ–¥–∏—Ç –≤—Ç–æ—Ä–æ–π –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ —Å–≤–æ–±–æ–¥–Ω—ã–π –±–ª–æ–∫, –∏—Å–∫–ª—é—á–∞—è —Ç–µ–∫—É—â–∏–π –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π.
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –±–ª–æ–∫–∞—Ö.

- ```static inline void update_max_free_block_on_detach(Arena *arena, size_t block_size)```
  - –û–±–Ω–æ–≤–ª—è–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞ –ø—Ä–∏ –æ—Ç—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–∏ –±–ª–æ–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.
  - –£—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–∞–∫–∏—Ö –±–ª–æ–∫–æ–≤.

- ```static void wipe_free_block(Arena *arena, Block *free_block, Block *tail)```
  - –û—á–∏—â–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–π –±–ª–æ–∫ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∞—Ä–µ–Ω—ã.
  - üîí –í–∞–∂–Ω—ã–π —É—á–∞—Å—Ç–æ–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é.

- ```static void merge_blocks(Arena *arena, Block *block1, Block *block2)```
  - –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–≤–∞ —Å–æ—Å–µ–¥–Ω–∏—Ö –±–ª–æ–∫–∞ –≤ –∞—Ä–µ–Ω–µ.
  - –ï—Å–ª–∏ –≤—Ç–æ—Ä–æ–π –±–ª–æ–∫ –ø—É—Å—Ç, –æ–Ω –æ—á–∏—â–∞–µ—Ç—Å—è.

- ```static void split_block(Arena *arena, Block *block, size_t size)```
  - –î–µ–ª–∏—Ç –±–ª–æ–∫ –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏, –µ—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –±–ª–æ–∫ —Å–ª–∏—à–∫–æ–º –≤–µ–ª–∏–∫.
  - –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –±–ª–æ–∫ —Å –æ—Å—Ç–∞–≤—à–∏–º—Å—è —Ä–∞–∑–º–µ—Ä–æ–º –∏ –ø–æ–º–µ—á–∞–µ—Ç –ø–µ—Ä–≤—ã–π –∫–∞–∫ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π.

- ```static void *alloc_in_tail(Arena *arena, size_t size)```
  - –í—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å –∏–∑ —Ö–≤–æ—Å—Ç–æ–≤–æ–π —á–∞—Å—Ç–∏ –∞—Ä–µ–Ω—ã.
  - –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –±–ª–æ–∫, –µ—Å–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞.

- ```static void *alloc_in_free_block(Arena *arena, size_t size)```
  - –í—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å –∏–∑ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞ –∞—Ä–µ–Ω—ã.
  - –î–µ–ª–∏—Ç –±–ª–æ–∫ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

- ```void *arena_alloc(Arena *arena, size_t size)```
  - –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏ –≤ –∞—Ä–µ–Ω–µ.
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `NULL`, –µ—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞.

- ```void arena_free_block(Arena *arena, void *data)```
  - –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –±–ª–æ–∫ –ø–∞–º—è—Ç–∏ –≤ –∞—Ä–µ–Ω–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –±–ª–æ–∫–æ–≤.
  - üîí –£–ø—Ä–∞–≤–ª—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –ø—Ä–∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–∏ –±–ª–æ–∫–æ–≤.

- ```Arena *arena_new_static(void *memory, size_t size)```
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é –∞—Ä–µ–Ω—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞—Ä–∞–Ω–µ–µ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏.
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `NULL`, –µ—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω.

- ```Arena *arena_new_dynamic(size_t size)```
  - –í—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∞—Ä–µ–Ω—ã –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –µ–µ.
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `NULL`, –µ—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–µ–Ω.

- ```void arena_reset(Arena *arena)```
  - –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∞—Ä–µ–Ω—É, –æ—á–∏—â–∞—è –±–ª–æ–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—è –µ–µ –≤ –Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.
  - –ë–µ–∑ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –ø–∞–º—è—Ç–∏.

- ```void arena_free(Arena *arena)```
  - –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–∞–º—è—Ç—å –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã—Ö –∞—Ä–µ–Ω.
  
- ```void print_arena(Arena *arena)```
  - –í—ã–≤–æ–¥–∏—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞—Ä–µ–Ω—ã –∏ –µ–µ –±–ª–æ–∫–æ–≤ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏.
  - –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏.

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- –í —Ñ–∞–π–ª–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä `Arena` –∏ `Block`, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞—Ä–µ–Ω—ã –∏ –±–ª–æ–∫–æ–≤.

### –ú–∞–∫—Ä–æ—Å—ã
- `MIN_BUFFER_SIZE` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ª–æ–≥–∏–∫–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–ª–æ–∫–æ–≤.

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
–§–∞–π–ª —Ä–µ–∞–ª–∏–∑—É–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –±–ª–æ–∫–æ–≤, –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤ –∞—Ä–µ–Ω—É. –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤–∫–ª—é—á–∞—é—Ç –≤—ã–¥–µ–ª–µ–Ω–∏–µ, –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤ –ø–∞–º—è—Ç–∏. –ü—Ä–∏ –≤—ã–¥–µ–ª–µ–Ω–∏–∏ –ø–∞–º—è—Ç–∏ —Ñ—É–Ω–∫—Ü–∏—è `arena_alloc` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–µ –º–µ—Å—Ç–æ –≤ —Ö–≤–æ—Å—Ç–µ –∏ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –±–ª–æ–∫–∞—Ö. –ï—Å–ª–∏ –±–ª–æ–∫ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `arena_free_block`, –æ–Ω –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å—Å—è —Å —Å–æ—Å–µ–¥–Ω–∏–º–∏ —Å–≤–æ–±–æ–¥–Ω—ã–º–∏ –±–ª–æ–∫–∞–º–∏, —Å–æ—Ö—Ä–∞–Ω—è—è —Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –≤ –∞—Ä–µ–Ω–µ. –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –∏ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.

## –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
### –ü—Ä–∏–º–µ—Ä
```c
Arena *my_arena = arena_new_dynamic(1024);
void *block1 = arena_alloc(my_arena, 256);
arena_free_block(my_arena, block1);
```
### –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–∞
–í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∞—Ä–µ–Ω–∞ —Ä–∞–∑–º–µ—Ä–æ–º 1024 –±–∞–π—Ç–∞. –ó–∞—Ç–µ–º –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –±–ª–æ–∫ —Ä–∞–∑–º–µ—Ä–æ–º 256 –±–∞–π—Ç —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ `arena_alloc`. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å –±–ª–æ–∫–æ–º –æ–Ω –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é `arena_free_block`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é –≤–µ—Ä–Ω—É—Ç—å –µ–≥–æ –≤ –ø—É–ª —Å–≤–æ–±–æ–¥–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

# core/src/button_handler.c

## –û–±—â–µ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–î–∞–Ω–Ω—ã–π —Ñ–∞–π–ª —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–Ω–æ–ø–æ–∫, –≤–∫–ª—é—á–∞—è —Å–æ–∑–¥–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –Ω–∞–∂–∞—Ç–∏–π. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∞—Å—Å–∏–≤–æ–º –∫–Ω–æ–ø–æ–∫ –∏ –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –≤–≤–æ–¥–æ–º. –§–∞–π–ª –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∫–∞–∫ —Å—Ç–∞—Ç–∏—á–µ—Å–∫—É—é, —Ç–∞–∫ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–Ω–æ–ø–æ–∫, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –§—É–Ω–∫—Ü–∏–∏
- ```inline Button **buttons_init(int length)```
  –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–æ–∫, –≤—ã–¥–µ–ª—è—è –ø–∞–º—è—Ç—å –¥–ª—è –º–∞—Å—Å–∏–≤–∞ –∫–Ω–æ–ø–æ–∫ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞.  
  –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (BUTTON_HANDLER_DYNAMIC).

- ```void add_button(ButtonHandler *button_handler, Button *button)```
  –î–æ–±–∞–≤–ª—è–µ—Ç –∫–Ω–æ–ø–∫—É –≤ –º–∞—Å—Å–∏–≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–Ω–æ–ø–æ–∫ –∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ –∫–Ω–æ–ø–æ–∫.  
  –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏ –∫–Ω–æ–ø–∫—É. –ï—Å–ª–∏ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–µ –≤–∞–ª–∏–¥–µ–Ω –∏–ª–∏ –º–∞—Å—Å–∏–≤ –ø–æ–ª–æ–Ω, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è.

- ```bool is_button(void *object, Coords coords)```
  –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∫–Ω–æ–ø–∫–∞ –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º.  
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `true`, –µ—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –Ω–∞–π–¥–µ–Ω–∞, –∏ `false` –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ.

- ```Button *get_button_by_coords(void *object, Coords coords)```
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–Ω–æ–ø–∫—É –ø–æ –µ–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º, –µ—Å–ª–∏ —Ç–∞–∫–æ–≤–∞—è –Ω–∞–π–¥–µ–Ω–∞; `NULL` –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ.  
  –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∫–Ω–æ–ø–æ–∫ –≤ –æ–±—ä–µ–∫—Ç–µ.

- ```void handle_button(void *object, Coords coords)```
  –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏, –∏–∑–≤–ª–µ–∫–∞—è –∫–Ω–æ–ø–∫—É –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º –∏ –≤—ã–∑—ã–≤–∞—è –µ–µ —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏—è –Ω–∞–∂–∞—Ç–∏—è (`on_click`).  
  –ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –Ω–∏–∫–∞–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –Ω–µ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è.

- ```void remove_button(ButtonHandler *button_handler, int index)```
  –£–¥–∞–ª—è–µ—Ç –∫–Ω–æ–ø–∫—É –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø–æ –∏–Ω–¥–µ–∫—Å—É, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –≤ `NULL` –∏ —É–º–µ–Ω—å—à–∞—è —Å—á–µ—Ç—á–∏–∫ –∫–Ω–æ–ø–æ–∫.  
  –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º.

- ```void set_button_context(ButtonHandler *button_handler, int index, void *context)```
  –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É.  
  –ï—Å–ª–∏ –∏–Ω–¥–µ–∫—Å –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã, –¥–µ–π—Å—Ç–≤–∏–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è.

- ```Button *get_button(ButtonHandler *button_handler, int index)```
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–Ω–æ–ø–∫—É –ø–æ –∏–Ω–¥–µ–∫—Å—É –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ; `NULL`, –µ—Å–ª–∏ –∏–Ω–¥–µ–∫—Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω.  
  –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–Ω–æ–ø–∫–∞–º –ø–æ—Å–ª–µ –∏—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏—è.

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- –ù–µ—Ç

### –ú–∞–∫—Ä–æ—Å—ã
- –ù–µ—Ç

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
–§–∞–π–ª —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–Ω–æ–ø–∫–∞–º–∏, —Ö—Ä–∞–Ω—è—â–∏–º–∏—Å—è –≤ –º–∞—Å—Å–∏–≤–µ, —É–ø—Ä–∞–≤–ª—è–µ–º–æ–º `ButtonHandler`. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è, —É–¥–∞–ª–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥–∏–±–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `HAVE_BUTTONS` –∏ `BUTTON_HANDLER`, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —É—Å–ª–æ–≤–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è –∫–Ω–æ–ø–æ–∫ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∏–∑ –æ–±—ä–µ–∫—Ç–∞, —Ç–µ–º —Å–∞–º—ã–º –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π.

–°–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—É `Button`, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –∫–∞–∂–¥–æ–π –∫–Ω–æ–ø–∫–µ –∏ —Ñ—É–Ω–∫—Ü–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–æ–π. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ª–æ–≥–∏–∫–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è: 
```c
ButtonHandler *handler = buttons_init(10);
add_button(handler, new_button);
Coords coords = {x: 100, y: 150};
handle_button(handler, coords);
```
- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–∞:
–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–æ–∫ —Å —Ä–∞–∑–º–µ—Ä–æ–º 10, –∑–∞—Ç–µ–º –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (100, 150) –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–∂–∞—Ç–∏—è –¥–ª—è –∫–Ω–æ–ø–∫–∏, –Ω–∞—Ö–æ–¥—è—â–µ–π—Å—è –≤ —ç—Ç–∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö, –µ—Å–ª–∏ —Ç–∞–∫–∞—è –∏–º–µ–µ—Ç—Å—è.

# core/src/container.c

## –û–±—â–µ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–î–∞–Ω–Ω—ã–π —Ñ–∞–π–ª —Ä–µ–∞–ª–∏–∑—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–ª—è –∫–∞—Ä—Ç. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –ø–∞–º—è—Ç–∏, –æ—á–∏—Å—Ç–∫–∏, –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—É—Å—Ç–æ—Ç—ã, –¥–æ–±–∞–≤–ª–µ–Ω–∏—è, –ø–æ–ª—É—á–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –Ω–∞–±–æ—Ä–æ–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Ä–∞–º–∫–∞—Ö –∏–≥—Ä—ã –∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–≥–æ –∫–∞—Ä—Ç–æ—á–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∫–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
### –§—É–Ω–∫—Ü–∏–∏
- ``Container *container_init(Arena *arena, int length)``
  –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞—Ä—Ç, –≤—ã–¥–µ–ª—è—è –ø–∞–º—è—Ç—å –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è –Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏ –∏—Å—Ç–æ—á–Ω–∏–∫.
- ``void container_free(Arena *arena, Container *container)``
  –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–∞–º—è—Ç—å, –≤—ã–¥–µ–ª–µ–Ω–Ω—É—é –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
- ``void container_clear_container(Container *container)``
  –û—á–∏—â–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ NULL –∏ —Å–±—Ä–∞—Å—ã–≤–∞—è —Ä–∞–∑–º–µ—Ä –∏ –∏—Å—Ç–æ—á–Ω–∏–∫.
- ``inline bool container_is_empty(const Container *container)``
  –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—É—Å—Ç –ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
- ``inline void container_set_source(Container *container, void *source)``
  –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π —É–∫–∞–∑–∞—Ç–µ–ª—å.
- ``void container_add_element(Container *container, void *element)``
  –î–æ–±–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.
- ``void *container_get_element(const Container *container, const int index)``
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É.
- ``void *container_pop_element(Container *container)``
  –£–¥–∞–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ.

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –ø–æ–∑–≤–æ–ª—è—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –∏—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –∏ —É–¥–∞–ª–µ–Ω–∏–µ–º. –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–Ω –≤—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å –≤ –∞—Ä–µ–Ω–µ, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–∞–º—è—Ç—å—é –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ. –°–≤—è–∑—å —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞—Ä–µ–Ω—ã –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏, —á—Ç–æ —É–ª—É—á—à–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏. 

–ê–ª–≥–æ—Ä–∏—Ç–º—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–Ω–¥–µ–∫—Å–æ–≤, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º–∏. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–∑–≤–æ–ª—è–µ—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å –∏–∑–º–µ–Ω—è–µ–º—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º.

## –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ü—Ä–∏–º–µ—Ä: 
```c
Arena *arena = arena_new_dynamic(1024);
Container *my_container = container_init(arena, 10);
```
- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–∞:
–í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∞—Ä–µ–Ω–∞ —Ä–∞–∑–º–µ—Ä–æ–º 1024 –±–∞–π—Ç–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω–æ–π 10. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å 10 —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –≤ —Ä–∞–º–∫–∞—Ö –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç–∏, –∏–∑–±–µ–≥–∞—è —É—Ç–µ—á–µ–∫ –∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏.

# core/src/core.c

## –û–±—â–µ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–î–∞–Ω–Ω—ã–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —è–¥—Ä–∞ –∏–≥—Ä–æ–≤–æ–≥–æ –¥–≤–∏–∂–∫–∞, –≤–∫–ª—é—á–∞—è –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É –∏–≥—Ä–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞–º–∏. –û–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –¥–≤–∏–∂–∫–∞, –∞ —Ç–∞–∫–∂–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–µ–π—Å—Ç–≤–∏–π –∏–≥—Ä–æ–∫–∞ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∏–≥—Ä–æ–≤—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –§—É–Ω–∫—Ü–∏–∏
- ``Core *core_init(Arena *arena)``
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —è–¥—Ä–∞, –≤—ã–¥–µ–ª—è—è –ø–∞–º—è—Ç—å –∏ —Å–≤—è–∑—ã–≤–∞—è —è–¥—Ä–æ —Å –∑–∞–¥–∞–Ω–Ω–æ–π –∞—Ä–µ–Ω–æ–π.
  
- ``void core_set_map(Core *core, Map *map)``
  - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É –¥–ª—è —è–¥—Ä–∞ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã.

- ``void core_set_cursor(Core *core, Cursor *cursor)``
  - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–π –∫—É—Ä—Å–æ—Ä –¥–ª—è —è–¥—Ä–∞.

- ``void core_set_screen(Core *core, Screen *screen)``
  - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–æ–≤—ã–π —ç–∫—Ä–∞–Ω –¥–ª—è —è–¥—Ä–∞.

- ``Screen *core_get_screen(Core *core)``
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —ç–∫—Ä–∞–Ω –∏–∑ —è–¥—Ä–∞.

- ``void core_shutdown(Core *core)``
  - –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –≤—Å–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã –∏ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É —ç–∫—Ä–∞–Ω–∞.

- ``void core_local_move(Core *core, Coords move)``
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –¥–≤–∏–∂–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞ –≤ —Ç–µ–∫—É—â–µ–º –æ–±—ä–µ–∫—Ç–µ.

- ``void core_action(Core *core)``
  - –†–µ–∞–ª–∏–∑—É–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É –∏–≥—Ä—ã –¥–ª—è –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ –∫–∞—Ä—Ç–∞–º–∏.

- ``void core_update_screen(Core *core)``
  - –û–±–Ω–æ–≤–ª—è–µ—Ç —ç–∫—Ä–∞–Ω —Å —Ç–µ–∫—É—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏–≥—Ä—ã.

- ``void core_global_move(Core *core, Coords move)``
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã.

- ``void core_free(Core *core)``
  - –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –≤—Å–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –æ–±—ä–µ–∫—Ç—ã –Ω–∞ –∫–∞—Ä—Ç–µ.

- ``void core_update(Core *core)``
  - –û–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã –Ω–∞ –∫–∞—Ä—Ç–µ, –≤—ã–∑—ã–≤–∞—è –∏—Ö –º–µ—Ç–æ–¥—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

- ``void core_validate_interfaces(Core *core)``
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å.

- ``void core_change_layer(Core *core, int layer)``
  - –ú–µ–Ω—è–µ—Ç —Å–ª–æ–π –∫–∞—Ä—Ç—ã –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∫—É—Ä—Å–æ—Ä–∞.

- ``void core_manage_loop(Core *core, wint_t key)``
  - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª –∏ –≤–≤–æ–¥ –∏–≥—Ä–æ–∫–∞.

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- `static CoreDependent core_dependent;`
  - –°—Ç—Ä—É–∫—Ç—É—Ä–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —è–¥—Ä–∞ –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ.

### –ú–∞–∫—Ä–æ—Å—ã
- `#define IS_CORE_DEPENDENT(object)` 
  - –ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–±—ä–µ–∫—Ç –∑–∞–≤–∏—Å–∏–º—ã–º –æ—Ç —è–¥—Ä–∞.
  
- `#define IS_INTERACTABLE(object)`
  - –ü—Ä–æ–≤–µ—Ä–∫–∞, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–±—ä–µ–∫—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º.

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
–î–∞–Ω–Ω—ã–π —Ñ–∞–π–ª —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ–º —è–¥—Ä–∞ —Å –∫–∞—Ä—Ç–æ–π –∏ –∫—É—Ä—Å–æ—Ä–æ–º. –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –∏–≥—Ä—ã –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π `core_manage_loop`, –∫–æ—Ç–æ—Ä–∞—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–≤–æ–¥ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã. –§—É–Ω–∫—Ü–∏–∏ `core_action` –∏ `core_local_move` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫–Ω–æ–ø–∫–∞–º–∏ –∏ –∫–∞—Ä—Ç–∞–º–∏, –≤—ã–∑—ã–≤–∞—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫—É—Ä—Å–æ—Ä–∞. 

–Ø–¥—Ä–æ —Ç–∞–∫–∂–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –ø–∞–º—è—Ç—å—é, –≤—ã–¥–µ–ª—è—è –µ—ë —á–µ—Ä–µ–∑ –∞—Ä–µ–Ω—É –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞—è –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã. –í—Å–µ –æ–±—ä–µ–∫—Ç—ã –∫–∞—Ä—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∏—Ö –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É.

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–ü—Ä–∏–º–µ—Ä:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —è–¥—Ä–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–∞—Ä—Ç—ã.
  
```c
Arena *arena = arena_new_dynamic(1024);
Core *core = core_init(arena);
core_set_map(core, my_map);
```

- **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–∞:** –í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∞—Ä–µ–Ω–∞ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏, –ø–æ—Å–ª–µ —á–µ–≥–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —è–¥—Ä–æ, —Å–≤—è–∑—ã–≤–∞—è –µ–≥–æ —Å –∞—Ä–µ–Ω–Ω–æ–π –ø–∞–º—è—Ç—å—é, –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–∞—Ä—Ç–∞, —á—Ç–æ –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç –∏–≥—Ä–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.

# core/src/cursor.c

## –û–±—â–µ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Ä–∞–±–æ—Ç—ã —Å –∫—É—Ä—Å–æ—Ä–æ–º, –≤–∫–ª—é—á–∞—è –µ–≥–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º. –ö—É—Ä—Å–æ—Ä –∏–≥—Ä–∞–µ—Ç –≤–∞–∂–Ω—É—é —Ä–æ–ª—å –≤ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ –Ω–∞ —ç–∫—Ä–∞–Ω–µ, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –≤–∏–∑—É–∞–ª—å–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –ø–æ–∑–∏—Ü–∏–∏ –∫—É—Ä—Å–æ—Ä–∞.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –§—É–Ω–∫—Ü–∏–∏
- ``Cursor *init_cursor(Arena *arena, void *start_object, Coords start_coords, Container *cursor_cards)``
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫—É—Ä—Å–æ—Ä —Å –∑–∞–¥–∞–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º –∏ –Ω–∞—á–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–µ–π.
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫—É—Ä—Å–æ—Ä–∞, –≥–æ—Ç–æ–≤—É—é –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.

- ``void print_cursor(Cursor *cursor, Screen *screen)``
  - –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –∫—É—Ä—Å–æ—Ä–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ –ø–æ–∑–∏—Ü–∏–∏.
  - –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç—É, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫—É—Ä—Å–æ—Ä, —É–ø—Ä–∞–≤–ª—è—Ç—å –µ–≥–æ –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º.

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –æ–±—ä—è–≤–ª–µ–Ω—ã –≤ –¥–∞–Ω–Ω–æ–º —Ñ–∞–π–ª–µ.

### –ú–∞–∫—Ä–æ—Å—ã
- –ú–∞–∫—Ä–æ—Å—ã –Ω–µ –æ–±—ä—è–≤–ª–µ–Ω—ã –≤ –¥–∞–Ω–Ω–æ–º —Ñ–∞–π–ª–µ.

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ –≤–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–∞ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–æ –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫—É—Ä—Å–æ—Ä–∞ –∏ –µ–≥–æ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏. –§—É–Ω–∫—Ü–∏—è `init_cursor` —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π –∫—É—Ä—Å–æ—Ä –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –µ–≥–æ –∞—Ç—Ä–∏–±—É—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –§—É–Ω–∫—Ü–∏—è `print_cursor` —É–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –∫—É—Ä—Å–æ—Ä–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ, –ø—Ä–æ–≤–µ—Ä—è—è, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–±—ä–µ–∫—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫—É—Ä—Å–æ—Ä, –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º, –∏, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –ø–æ–∑–≤–æ–ª—è—è —ç—Ç–æ–º—É –æ–±—ä–µ–∫—Ç—É —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –∫—É—Ä—Å–æ—Ä–∞ (–æ–±—ã—á–Ω—ã–π –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π) –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–∂–µ—Ç –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏.

## –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–°–∞–º –ø—Ä–∏–º–µ—Ä:**
  ```c
  Arena *arena = ...; // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ –∞—Ä–µ–Ω–∞ –±—ã–ª–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
  Coords start_coords = {.x = 0, .y = 0};
  void *start_object = ...; // –û–±—ä–µ–∫—Ç, —Å –∫–æ—Ç–æ—Ä—ã–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç –∫—É—Ä—Å–æ—Ä
  Container *cursor_cards = ...; // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–∞—Ä—Ç –∫—É—Ä—Å–æ—Ä–∞
  Cursor *cursor = init_cursor(arena, start_object, start_coords, cursor_cards);
  print_cursor(cursor, screen);
  ```
- **–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–∞:**
  –í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—Ä–µ–Ω—ã –∏ –¥—Ä—É–≥–∏—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª–æ–∂–µ–Ω–∏—è –∫—É—Ä—Å–æ—Ä–∞ –∏ –æ–±—ä–µ–∫—Ç, —Å –∫–æ—Ç–æ—Ä—ã–º –æ–Ω –±—É–¥–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å. –ó–∞—Ç–µ–º –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `init_cursor`, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–∑–¥–∞–µ—Ç –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∫—É—Ä—Å–æ—Ä, –ø–æ—Å–ª–µ —á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `print_cursor` –¥–ª—è –µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ. –≠—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–∏–¥–µ—Ç—å –∫—É—Ä—Å–æ—Ä –≤ –∑–∞–¥–∞–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ –∏ —Å –∑–∞–¥–∞–Ω–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.

# core/src/map.c

## –û–±—â–µ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–§–∞–π–ª —Ä–µ–∞–ª–∏–∑—É–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ–π, –≤–∫–ª—é—á–∞—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞–º–∏ –∫–∞—Ä—Ç—ã –∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞. –û–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã, —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª–æ–µ–≤, –∞ —Ç–∞–∫–∂–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –∫—É—Ä—Å–æ—Ä–∞ –ø–æ –∫–∞—Ä—Ç–µ. –û–±—ä–µ–∫—Ç—ã –Ω–∞ –∫–∞—Ä—Ç–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –Ω–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∏–≥—Ä–æ–≤—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –§—É–Ω–∫—Ü–∏–∏
- ``Map *init_map(Arena *arena, int layers, Coords global_coords)``
  –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–∞—Ä—Ç—ã, –≤—ã–¥–µ–ª—è—è –ø–∞–º—è—Ç—å –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞ —Å–ª–æ–µ–≤ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.
  
- ``void map_set_layer(Map *map, MapLayer *map_layer, int layer)``
  –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–ª–æ–π –∫–∞—Ä—Ç—ã –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É.

- ``MapLayer *map_get_layer(Map *map, int layer)``
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–π –∫–∞—Ä—Ç—ã –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∏–Ω–¥–µ–∫—Å—É.

- ``inline MapLayer *map_get_current_layer(Map *map)``
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ç–µ–∫—É—â–∏–π —Å–ª–æ–π –∫–∞—Ä—Ç—ã.

- ``void map_move(Map *map, Coords move)``
  –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç –∫—É—Ä—Å–æ—Ä –Ω–∞ –∫–∞—Ä—Ç–µ –≤ –Ω–æ–≤—É—é –ø–æ–∑–∏—Ü–∏—é, –ø—Ä–æ–≤–µ—Ä—è—è –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Ü–µ–ª–µ–≤–æ–π –ø–æ–∑–∏—Ü–∏–µ–π.

- ``void map_move_layer(Map *map, int layer)``
  –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç –∫—É—Ä—Å–æ—Ä –Ω–∞ –¥—Ä—É–≥–æ–π —Å–ª–æ–π –∫–∞—Ä—Ç—ã, –æ–±–Ω–æ–≤–ª—è—è –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã.

- ``inline MapObject map_get_current_object(Map *map)``
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç –∫–∞—Ä—Ç—ã –ø–æ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏ –∫—É—Ä—Å–æ—Ä–∞.

- ``inline MapObject map_get_object(Map *map, Coords coords)``
  –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç –∫–∞—Ä—Ç—ã –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º.

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
–§—É–Ω–∫—Ü–∏–∏ –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ —É–ø—Ä–∞–≤–ª—è—é—Ç –æ–±—ä–µ–∫—Ç–∞–º–∏ –Ω–∞ –∫–∞—Ä—Ç–µ, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è —Å—Ä–µ–¥—Å—Ç–≤–∞ –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –∫—É—Ä—Å–æ—Ä–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ –∏—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º. –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–ª–æ–µ–≤ –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏. –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤–∞–ª–∏–¥–Ω–æ–º –≤—Ö–æ–¥–µ, –∞ —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –æ–±—ä–µ–∫—Ç–∞–º–∏. –ü—Ä–∏ —Å–º–µ–Ω–µ —Å–ª–æ—è –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫—É—Ä—Å–æ—Ä–∞ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –Ω–æ–≤—ã–º —É—Å–ª–æ–≤–∏—è–º. 

## –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ä—Ç—ã:
```c
Map *my_map = init_map(arena, 3, (Coords){0, 0, 0});
```
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–ª–æ—è –≤ –∫–∞—Ä—Ç–µ:
```c
map_set_layer(my_map, my_layer, 0);
```
- –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫—É—Ä—Å–æ—Ä–∞ –Ω–∞ –∫–∞—Ä—Ç–µ:
```c
map_move(my_map, (Coords){1, 0, 0});
```
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º –∫—É—Ä—Å–æ—Ä–∞:
```c
MapObject current_object = map_get_current_object(my_map);
```
- –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–∞—Ä—Ç–∞, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–ª–æ–π, –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç—Å—è –∫—É—Ä—Å–æ—Ä –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è —Ç–µ–∫—É—â–∏–π –æ–±—ä–µ–∫—Ç. –≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤ —Ä–∞–º–∫–∞—Ö —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ–π.

# core/src/screen.c

## –û–±—â–µ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–§–∞–π–ª —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ –Ω–∞ —ç–∫—Ä–∞–Ω –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—É—Ñ–µ—Ä–æ–º —ç–∫—Ä–∞–Ω–∞. –û–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ü–≤–µ—Ç–∞–º–∏, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —ç–∫—Ä–∞–Ω–∞, –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∫—É—Ä—Å–æ—Ä–∞, –∞ —Ç–∞–∫–∂–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–º –∏ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –Ω–∞ —ç–∫—Ä–∞–Ω–µ.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –§—É–Ω–∫—Ü–∏–∏
- ``const char *get_foreground(Color color)``
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç ANSI escape –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ —Ç–µ–∫—Å—Ç–∞.
  
- ``const char *get_background(Color color)``
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç ANSI escape –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ü–≤–µ—Ç–∞ —Ñ–æ–Ω–∞.

- ``Screen *init_screen(Arena *arena, int width, int height, Color background, Color foreground, wchar_t symbol)``
  - –°–æ–∑–¥–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —ç–∫—Ä–∞–Ω–∞ —Å –æ—á–∏—â–µ–Ω–Ω—ã–º–∏ –±—É—Ñ–µ—Ä–∞–º–∏ –∏ –∑–∞–¥–∞–Ω–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏.

- ``void screen_shutdown(Screen *screen)``
  - –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∏ –æ—á–∏—â–∞–µ—Ç —ç–∫—Ä–∞–Ω.

- ``void add_borders(Screen *screen, int y, int x, int height, int width, Color background, Color foreground, const wchar_t *borders)``
  - –°–æ–∑–¥–∞–µ—Ç —Ä–∞–º–∫—É —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ —Ä–∞–º–∫–∏.

- ``void add_separator(Screen *screen, int y, int x, Color background, Color foreground , const wchar_t *borders)``
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ–±–ª–∞—Å—Ç–µ–π —ç–∫—Ä–∞–Ω–∞.

- ``void print_screen(const Screen *screen)``
  - –í—ã–≤–æ–¥–∏—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —ç–∫—Ä–∞–Ω–∞ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

- ``void fill_area(Screen *screen, int y, int x, int height, int width, wchar_t symbol, Color background, Color foreground)``
  - –ó–∞–ø–æ–ª–Ω—è–µ—Ç –æ–±–ª–∞—Å—Ç—å —ç–∫—Ä–∞–Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–º —Å–∏–º–≤–æ–ª–æ–º –∏ —Ü–≤–µ—Ç–∞–º–∏.

- ``void insert_text(Screen *screen, int y, int x, const char *text, Color foreground, Color background)``
  - –í—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –Ω–∞ —ç–∫—Ä–∞–Ω –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏.

- ``void set_noncanonical_mode(void)``
  - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ –Ω–µ–∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º.

- ``void restore_terminal_settings(void)``
  - –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª –∫ –µ–≥–æ –∏—Å—Ö–æ–¥–Ω—ã–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º.

- ``static const wchar_t* get_cursor_string(CursorType type)``
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç—Ä–æ–∫—É –∫—É—Ä—Å–æ—Ä–∞ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –∫—É—Ä—Å–æ—Ä–∞.

- ``void screen_draw_cursor(Screen *screen, Coords coords, CursorConfig config)``
  - –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –∫—É—Ä—Å–æ—Ä –Ω–∞ —ç–∫—Ä–∞–Ω–µ –≤ –∑–∞–¥–∞–Ω–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö.

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ –¥–∞–Ω–Ω–æ–º –∫–æ–¥–µ.

### –ú–∞–∫—Ä–æ—Å—ã
- –ú–∞–∫—Ä–æ—Å—ã –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ –¥–∞–Ω–Ω–æ–º –∫–æ–¥–µ.

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
–§—É–Ω–∫—Ü–∏–∏ –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –±—É—Ñ–µ—Ä–æ–º —ç–∫—Ä–∞–Ω–∞, —É–ø—Ä–∞–≤–ª—è—è —Ü–≤–µ—Ç–∞–º–∏ –∏ –≤—ã–≤–æ–¥–æ–º —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤. –ü—Ä–æ—Ü–µ—Å—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —ç–∫—Ä–∞–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–∏–∫—Å–µ–ª–µ–π, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –∏–º–µ–µ—Ç —Ñ–æ–Ω–æ–≤—ã–π –∏ –ø–µ—Ä–µ–¥–Ω–∏–π —Ü–≤–µ—Ç. –§—É–Ω–∫—Ü–∏—è `print_screen` –≤—ã–≤–æ–¥–∏—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –±—É—Ñ–µ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É—è ANSI escape –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–≤–µ—Ç–∞ —Ç–µ–∫—Å—Ç–∞ –∏ —Ñ–æ–Ω–∞. –î–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–∞–º–æ–∫ –∏ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π, –∞ —Ç–∞–∫–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞.

–§—É–Ω–∫—Ü–∏–∏ `set_noncanonical_mode` –∏ `restore_terminal_settings` —É–ø—Ä–∞–≤–ª—è—é—Ç —Ä–µ–∂–∏–º–∞–º–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏ Enter. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è –±–æ–ª–µ–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º.

## –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ü—Ä–∏–º–µ—Ä:
  ```c
  Screen *screen = init_screen(arena, 80, 25, COLOR_BLACK, COLOR_WHITE, L' ');
  fill_area(screen, 0, 0, 25, 80, L' ', COLOR_BLUE, COLOR_WHITE);
  print_screen(screen);
  screen_shutdown(screen);
  ```

- –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–∞:
  –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —ç–∫—Ä–∞–Ω —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏ 80x25, —á–µ—Ä–Ω—ã–º —Ñ–æ–Ω–æ–º –∏ –±–µ–ª—ã–º —Ç–µ–∫—Å—Ç–æ–º. –ó–∞—Ç–µ–º –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–±–ª–∞—Å—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω–µ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (0,0) –¥–æ (25,80) —Å–∏–Ω–∏–º —Ü–≤–µ—Ç–æ–º. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —ç–∫—Ä–∞–Ω–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è –Ω–∞ —Ç–µ—Ä–º–∏–Ω–∞–ª, –∏ –≤ –∫–æ–Ω—Ü–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞.

# core/src/validate.c

## –û–±—â–µ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–§–∞–π–ª —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –∏–≥—Ä–æ–≤–æ–º –¥–≤–∏–∂–∫–µ. –≠—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç–æ–≤. –ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –≤ —Å–ª—É—á–∞–µ –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è.

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –§—É–Ω–∫—Ü–∏–∏
- ```static bool validate_drawable(const void *interface, const char *name)```
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Drawable –∏ –µ–≥–æ —Ñ—É–Ω–∫—Ü–∏—è `print`. –í—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –≤ —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º.
  
- ```static bool validate_interactable(const void *interface, const char *name)```
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ Interactable: `move`, `place_cursor`, `get_default_coords`, `get_cursor_config`. –£–≤–µ–¥–æ–º–ª—è–µ—Ç –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–π –∏–∑ –Ω–∏—Ö.
  
- ```static bool validate_card_handler(const void *interface, const char *name)```
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–∞—Ä—Ç–∞–º–∏ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ CardHandler. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π `can_give_cards` –∏ `can_take_cards`.
  
- ```static bool validate_button_handler(const void *interface, const char *name)```
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ButtonHandler –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏. 

- ```static bool validate_position_handler(const void *interface, const char *name)```
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–∑–∏—Ü–∏–π –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ PositionHandler: `restore_pos`, `save_current_pos`.
  
- ```static bool validate_dynamic(const void *interface, const char *name)```
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ `free` –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Dynamic, –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤.

- ```static bool validate_updateable(const void *interface, const char *name)```
  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Updateable —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏—é `update`, –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –¥–ª—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –æ–±—ä–µ–∫—Ç–æ–≤.

- ```bool validate_object_interfaces(const ObjectInterfaces *interfaces)```
  - –í—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –æ–±—ä–µ–∫—Ç–∞. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç false, –µ—Å–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å –Ω–µ—É–¥–∞—á–µ–π.

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
- `validators[]` - –º–∞—Å—Å–∏–≤ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É, —Å–æ–¥–µ—Ä–∂–∞—â—É—é —Ñ–ª–∞–≥ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏ —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ —Ñ—É–Ω–∫—Ü–∏—é –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
–ö–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Ñ—É–Ω–∫—Ü–∏–π –∏ –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –≤ —Å–ª—É—á–∞–µ –∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è. –§—É–Ω–∫—Ü–∏—è `validate_object_interfaces` –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç —ç—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –æ–±—ä–µ–∫—Ç–∞, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è, —á—Ç–æ –æ–±—ä–µ–∫—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º. –ï—Å–ª–∏ –ª—é–±–æ–π –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –Ω–µ –ø—Ä–æ—à–µ–ª –≤–∞–ª–∏–¥–∞—Ü–∏—é, –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–∞–µ—Ç false, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∞–≤–∞—Ä–∏–π–Ω–æ–º—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é –ø—Ä–æ–≥—Ä–∞–º–º—ã.

## –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ `validate_object_interfaces`:
  - –î–ª—è –æ–±—ä–µ–∫—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Drawable`, `Interactable`, –∏ `CardHandler`, –≤–∞–ª–∏–¥–∞—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

  ```c
  ObjectInterfaces interfaces;
  // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã interfaces —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
  bool is_valid = validate_object_interfaces(&interfaces);
  ```

  - –í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ, –µ—Å–ª–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º, –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–≤–µ–¥–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö, —É–∫–∞–∑—ã–≤–∞—é—â–∏–µ –Ω–∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∏ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Å –∫–æ–¥–æ–º 1.

